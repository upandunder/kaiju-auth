<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kaiju Authentication</title>
    <style>
        body, html { margin: 0; padding: 0; height: 100%; overflow: hidden; background: #1a1a1a; }
        #canvas-container { width: 100%; height: 100%; }
        #loading { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
                   color: #FFD700; font-family: Arial; font-size: 18px; }
    </style>
</head>
<body>
    <div id="canvas-container"></div>
    <div id="loading">Cargando tarjeta 3D...</div>

    <!-- Three.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/GLTFLoader.js"></script>

    <script type="module">
        class KaijuAuthCard {
            constructor() {
                this.scene = new THREE.Scene();
                this.scene.background = new THREE.Color(0x1a1a1a);

                this.camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
                this.camera.position.set(0, 0, 6);

                this.renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
                this.renderer.setSize(window.innerWidth, window.innerHeight);
                this.renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
                document.getElementById('canvas-container').appendChild(this.renderer.domElement);

                this.cardGroup = new THREE.Group();
                this.scene.add(this.cardGroup);

                window.addEventListener('resize', () => this.onWindowResize());

                this.loadGLBModel();
                this.animate();
            }

            async loadGLBModel() {
                try {
                    const loader = new THREE.GLTFLoader();
                    const modelUrl = 'https://github.com/upandunder/kaiju-auth/raw/refs/heads/main/tarjeta.glb';
                    
                    const gltf = await new Promise((resolve, reject) => {
                        loader.load(
                            modelUrl,
                            (gltf) => resolve(gltf),
                            (xhr) => {
                                const percent = Math.round((xhr.loaded / xhr.total) * 100);
                                document.getElementById('loading').innerText = `Cargando tarjeta 3D... ${percent}%`;
                            },
                            (error) => reject(error)
                        );
                    });

                    this.cardModel = gltf.scene;

                    // Centrar modelo
                    const box = new THREE.Box3().setFromObject(this.cardModel);
                    const center = box.getCenter(new THREE.Vector3());
                    this.cardModel.position.sub(center);

                    this.cardGroup.add(this.cardModel);

                    document.getElementById('loading').style.display = 'none';
                    console.log('GLB cargado correctamente');
                } catch (error) {
                    console.error('Error cargando GLB:', error);
                    document.getElementById('loading').innerText = 'Error cargando tarjeta 3D';
                }
            }

            animate() {
                requestAnimationFrame(() => this.animate());
                if (this.cardGroup) this.cardGroup.rotation.y += 0.005; // rotaci√≥n lenta
                this.renderer.render(this.scene, this.camera);
            }

            onWindowResize() {
                this.camera.aspect = window.innerWidth / window.innerHeight;
                this.camera.updateProjectionMatrix();
                this.renderer.setSize(window.innerWidth, window.innerHeight);
            }
        }

        new KaijuAuthCard();
    </script>
</body>
</html>
